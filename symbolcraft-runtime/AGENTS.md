
  ğŸ¯ SymbolCraft å®ç°å†…ç½®å›¾æ ‡åº“çš„æ–¹æ¡ˆ

  æ–¹æ¡ˆ 1: é¢„ç”Ÿæˆ AAR/JAR åº“ (æ¨è â­â­â­â­â­)

  æ ¸å¿ƒæ€è·¯:
  - é¢„å…ˆç”Ÿæˆæ‰€æœ‰ Material Symbols å›¾æ ‡åˆ°ç‹¬ç«‹åº“
  - ç»“åˆ Tree Shaking åœ¨ç¼–è¯‘æ—¶å‰”é™¤æœªä½¿ç”¨çš„å›¾æ ‡
  - ç±»ä¼¼ material-icons-extended çš„ä½¿ç”¨ä½“éªŒ

  æ¶æ„è®¾è®¡

  symbolcraft-runtime/              # è¿è¡Œæ—¶æ ¸å¿ƒåº“ (50KB)
  â”œâ”€â”€ Icons.kt                      # å›¾æ ‡è®¿é—®å…¥å£
  â””â”€â”€ LazyImageVector.kt           # æ‡’åŠ è½½æ”¯æŒ

  symbolcraft-material-symbols/     # é¢„ç”Ÿæˆå›¾æ ‡åº“ (æŒ‰éœ€æ‹†åˆ†)
  â”œâ”€â”€ outlined/                     # 3000+ å›¾æ ‡ Ã— 7 æƒé‡ = 21000 ä¸ª
  â”‚   â”œâ”€â”€ weight-400/               # å•ç‹¬æ¨¡å— (~2MB)
  â”‚   â”œâ”€â”€ weight-500/
  â”‚   â””â”€â”€ weight-700/
  â”œâ”€â”€ rounded/
  â””â”€â”€ sharp/

  symbolcraft-compiler/             # ç¼–è¯‘å™¨æ’ä»¶
  â””â”€â”€ TreeShakingTransformer.kt    # R8/ProGuard è§„åˆ™ç”Ÿæˆ

  å®ç°æ­¥éª¤

  æ­¥éª¤ 1: åˆ›å»ºç‹¬ç«‹å›¾æ ‡åº“é¡¹ç›®

  // symbolcraft-material-symbols/build.gradle.kts
  plugins {
      kotlin("multiplatform")
      id("com.android.library")
  }

  kotlin {
      androidTarget()
      jvm()
      iosArm64()
      iosSimulatorArm64()

      sourceSets {
          commonMain {
              dependencies {
                  api(project(":symbolcraft-runtime"))
              }
          }
      }
  }

  // æ„å»ºæ—¶è¿è¡Œç”Ÿæˆä»»åŠ¡
  tasks.register("generateAllIcons") {
      doLast {
          // ä½¿ç”¨ SymbolCraft æ’ä»¶ç”Ÿæˆæ‰€æœ‰å›¾æ ‡
          // è¾“å‡ºåˆ° src/commonMain/kotlin/generated/
      }
  }

  æ­¥éª¤ 2: è®¾è®¡æ‡’åŠ è½½æœºåˆ¶

  // symbolcraft-runtime/src/commonMain/kotlin/Icons.kt
  package io.github.kingsword09.symbolcraft.runtime

  import androidx.compose.ui.graphics.vector.ImageVector

  /**
   * å›¾æ ‡è®¿é—®å…¥å£
   * ç±»ä¼¼ androidx.compose.material.icons.Icons
   */
  object MaterialSymbols {
      object Outlined {
          object W400 {
              val Home: ImageVector by lazy {
                  io.github.kingsword09.symbolcraft.icons.outlined.w400.HomeIcon
              }
              val Search: ImageVector by lazy {
                  io.github.kingsword09.symbolcraft.icons.outlined.w400.SearchIcon
              }
              // ... 3000+ å›¾æ ‡
          }
          object W500 { /* ... */ }
          object W700 { /* ... */ }
      }

      object Rounded { /* ... */ }
      object Sharp { /* ... */ }
  }

  æ­¥éª¤ 3: ç”Ÿæˆ Tree Shaking è§„åˆ™

  // symbolcraft-compiler/src/main/kotlin/TreeShakingTransformer.kt
  class SymbolCraftTreeShakingTask : DefaultTask() {

      @TaskAction
      fun generateProguardRules() {
          val usedIcons = analyzeUsedIcons()

          // ç”Ÿæˆ R8/ProGuard è§„åˆ™
          val rules = buildString {
              appendLine("# SymbolCraft Tree Shaking Rules")
              appendLine("# Generated by SymbolCraft Compiler")
              appendLine()

              // ä¿ç•™ä½¿ç”¨çš„å›¾æ ‡
              for (icon in usedIcons) {
                  appendLine("-keep class ${icon.fullyQualifiedName} { *; }")
              }

              // ç§»é™¤æœªä½¿ç”¨çš„å›¾æ ‡
              appendLine("-assumenosideeffects class io.github.kingsword09.symbolcraft.icons.** {")
              appendLine("    <init>(...);")
              appendLine("}")
          }

          File("build/symbolcraft/proguard-rules.pro").writeText(rules)
      }
  }

  æ­¥éª¤ 4: ç”¨æˆ·ä½¿ç”¨æ–¹å¼

  // build.gradle.kts
  dependencies {
      // æ–¹å¼1: å®Œæ•´åº“ (å«æ‰€æœ‰æƒé‡å’Œæ ·å¼)
      implementation("io.github.kingsword09:symbolcraft-material-symbols:0.4.0")

      // æ–¹å¼2: æŒ‰éœ€å¼•å…¥ (æ¨è)
      implementation("io.github.kingsword09:symbolcraft-material-symbols-outlined-w400:0.4.0")
      implementation("io.github.kingsword09:symbolcraft-material-symbols-rounded-w500:0.4.0")
  }

  // App.kt
  import io.github.kingsword09.symbolcraft.MaterialSymbols

  @Composable
  fun MyScreen() {
      // ç›´æ¥ä½¿ç”¨ï¼Œç±»ä¼¼ material-icons-extended
      Icon(
          imageVector = MaterialSymbols.Outlined.W400.Home,
          contentDescription = "Home"
      )

      Icon(
          imageVector = MaterialSymbols.Rounded.W500.Search,
          contentDescription = "Search"
      )
  }

  æ–¹æ¡ˆ 2: Gradle æ’ä»¶ + æœ¬åœ°ç¼“å­˜ (å½“å‰æ–¹æ¡ˆå¢å¼º)

  ä¿æŒå½“å‰ SymbolCraft æ’ä»¶æ–¹å¼ï¼Œä½†å¢åŠ ä¾¿åˆ©æ€§:

  symbolCraft {
      // æ–°å¢: å¿«é€Ÿå¯ç”¨æ¨¡å¼
      presets {
          materialSymbolsAll(
              weights = listOf(400, 500, 700),
              variants = listOf(SymbolVariant.OUTLINED, SymbolVariant.ROUNDED)
          )
      }

      // å¯ç”¨æ™ºèƒ½ Tree Shaking
      treeShaking {
          enabled = true
          mode = TreeShakingMode.AUTO  // è‡ªåŠ¨åˆ†æå¹¶è¿‡æ»¤
      }
  }

  è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰å›¾æ ‡ç´¢å¼•:

  // ç”Ÿæˆ MaterialSymbolsIndex.kt
  object MaterialSymbolsIndex {
      val allIcons = setOf(
          "home", "search", "settings", /* 3000+ ä¸ªå›¾æ ‡å */
      )

      fun generateAll() {
          allIcons.forEach { iconName ->
              // æŒ‰éœ€ç”Ÿæˆ
          }
      }
  }

  æ–¹æ¡ˆ 3: æ··åˆæ–¹æ¡ˆ (æœ€ä½³ä½“éªŒ â­â­â­â­â­)

  ç»“åˆæ–¹æ¡ˆ 1 å’Œæ–¹æ¡ˆ 2 çš„ä¼˜ç‚¹:

  // 1. å¼€å‘é˜¶æ®µ: ä½¿ç”¨é¢„æ„å»ºåº“
  dependencies {
      debugImplementation("io.github.kingsword09:symbolcraft-material-symbols:0.4.0")
  }

  // 2. ç”Ÿäº§æ„å»º: è‡ªåŠ¨ Tree Shaking
  plugins {
      id("io.github.kingsword09.symbolcraft") version "0.4.0"
  }

  symbolCraft {
      // è‡ªåŠ¨æ›¿æ¢ä¸ºç²¾ç®€ç‰ˆæœ¬
      treeShaking {
          enabled = true
          replaceDebugLibrary = true  // Release æ—¶æ›¿æ¢ä¸ºç”Ÿæˆçš„å›¾æ ‡
      }
  }

  ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

  | ç‰¹æ€§           | Material Icons Extended | æ–¹æ¡ˆ1 (é¢„ç”Ÿæˆåº“) | æ–¹æ¡ˆ2 (å¢å¼ºæ’ä»¶) | æ–¹æ¡ˆ3 (æ··åˆ) |
  |--------------|-------------------------|------------|------------|----------|
  | é›¶é…ç½®ä½¿ç”¨        | âœ…                       | âœ…          | âŒ (éœ€é…ç½®)    | âœ…        |
  | åŒ…ä½“ç§¯          | âŒ 11.3MB                | âš ï¸ å–å†³äºæ‹†åˆ†   | âœ… æœ€å°       | âœ… æœ€å°     |
  | IDE ä½“éªŒ       | âœ… å®Œç¾                    | âœ… å®Œç¾       | âš ï¸ ä¸€èˆ¬      | âœ… å®Œç¾     |
  | æ ·å¼å®šåˆ¶         | âŒ                       | âš ï¸ æœ‰é™      | âœ… å®Œå…¨å®šåˆ¶     | âœ… å®Œå…¨å®šåˆ¶   |
  | Tree Shaking | âŒ                       | âœ…          | âœ…          | âœ…        |
  | æ„å»ºé€Ÿåº¦         | âœ… å¿«                     | âœ… å¿«        | âš ï¸ è¾ƒæ…¢      | âœ… å¿«      |

  ğŸ›  å®æ–½æ–¹æ¡ˆ (æ··åˆæ–¹æ¡ˆè¯¦ç»†è®¾è®¡)

  1. é¡¹ç›®ç»“æ„

  SymbolCraft/
  â”œâ”€â”€ symbolcraft-runtime/          # è¿è¡Œæ—¶æ ¸å¿ƒ
  â”‚   â””â”€â”€ src/commonMain/kotlin/
  â”‚       â””â”€â”€ MaterialSymbols.kt
  â”‚
  â”œâ”€â”€ symbolcraft-material-symbols/ # é¢„ç”Ÿæˆåº“
  â”‚   â”œâ”€â”€ full/                     # å®Œæ•´ç‰ˆ (æ‰€æœ‰å›¾æ ‡)
  â”‚   â”œâ”€â”€ outlined-w400/            # æ‹†åˆ†æ¨¡å—
  â”‚   â”œâ”€â”€ outlined-w500/
  â”‚   â””â”€â”€ rounded-w500/
  â”‚
  â”œâ”€â”€ symbolcraft-compiler/         # ç¼–è¯‘å™¨æ’ä»¶
  â”‚   â””â”€â”€ TreeShakingPlugin.kt
  â”‚
  â””â”€â”€ symbolcraft-gradle-plugin/    # Gradle æ’ä»¶ (ç°æœ‰)

  2. é¢„ç”Ÿæˆè„šæœ¬

  // scripts/GeneratePrebuiltLibrary.main.kts
  import io.github.kingsword09.symbolcraft.*

  /**
   * ç”Ÿæˆé¢„æ„å»ºå›¾æ ‡åº“
   * è¿è¡Œ: ./gradlew :symbolcraft-material-symbols:generatePrebuilt
   */
  val generator = PrebuiltLibraryGenerator(
      outputDir = File("symbolcraft-material-symbols/full/src/commonMain/kotlin"),
      packageName = "io.github.kingsword09.symbolcraft.icons"
  )

  // ç”Ÿæˆæ‰€æœ‰å›¾æ ‡
  val allMaterialSymbols = fetchAllIconNames() // ä» Google Fonts API è·å–
  allMaterialSymbols.forEach { iconName ->
      listOf(400, 500, 700).forEach { weight ->
          SymbolVariant.values().forEach { variant ->
              generator.generateIcon(
                  name = iconName,
                  weight = weight,
                  variant = variant
              )
          }
      }
  }

  generator.generateIndex() // ç”Ÿæˆç´¢å¼•æ–‡ä»¶

  3. Tree Shaking é›†æˆ

  // symbolcraft-compiler/src/main/kotlin/TreeShakingPlugin.kt
  class SymbolCraftCompilerPlugin : KotlinCompilerPluginSupportPlugin {

      override fun apply(target: Project) {
          // åœ¨ç¼–è¯‘å‰åˆ†æå›¾æ ‡ä½¿ç”¨æƒ…å†µ
          target.tasks.withType<KotlinCompile>().configureEach {
              doFirst {
                  val analyzer = IconUsageAnalyzer()
                  val usedIcons = analyzer.analyze(target)

                  // ç”Ÿæˆä¿ç•™è§„åˆ™
                  generateKeepRules(usedIcons, target)
              }
          }
      }

      private fun generateKeepRules(icons: Set<String>, project: Project) {
          val rulesFile = project.file("build/symbolcraft/keep-rules.pro")
          rulesFile.writeText("""
              # Keep used Material Symbols
              ${icons.joinToString("\n") { "-keep class $it { *; }" }}
              
              # Remove unused icons
              -assumenosideeffects class io.github.kingsword09.symbolcraft.icons.** {
                  <init>(...);
              }
          """.trimIndent())

          // è‡ªåŠ¨æ·»åŠ åˆ° Android proguardFiles
          project.android?.defaultConfig?.proguardFiles(rulesFile)
      }
  }

  4. ç”¨æˆ·ä½“éªŒ

  å¼€å‘é˜¶æ®µ

  // build.gradle.kts
  dependencies {
      // å¼€å‘æ—¶ä½¿ç”¨å®Œæ•´åº“ï¼ŒIDE è‡ªåŠ¨è¡¥å…¨
      debugImplementation("io.github.kingsword09:symbolcraft-material-symbols-full:0.4.0")
  }

  // App.kt
  import io.github.kingsword09.symbolcraft.MaterialSymbols

  @Composable
  fun MyScreen() {
      Icon(MaterialSymbols.Outlined.W400.Home, "Home")
      Icon(MaterialSymbols.Rounded.W500.Search, "Search")
  }

  ç”Ÿäº§æ„å»º

  // build.gradle.kts
  plugins {
      id("io.github.kingsword09.symbolcraft") version "0.4.0"
  }

  symbolCraft {
      treeShaking {
          enabled = true

          // è‡ªåŠ¨æ¨¡å¼: åˆ†æä»£ç å¹¶ç”Ÿæˆæœ€å°é›†
          mode = TreeShakingMode.AUTO

          // Release æ„å»ºæ—¶æ›¿æ¢ä¸ºç”Ÿæˆçš„å›¾æ ‡
          replaceInRelease = true
      }
  }

  // æ„å»ºè¾“å‡º:
  // âœ… Debug APK: 15MB (ä½¿ç”¨é¢„æ„å»ºåº“)
  // âœ… Release APK: 5MB (ä½¿ç”¨ Tree Shaking åçš„ç²¾ç®€ç‰ˆ)

  ğŸš€ å®æ–½è·¯çº¿å›¾

  ç¬¬ä¸€é˜¶æ®µ (2å‘¨)

  1. âœ… åˆ›å»º symbolcraft-runtime æ¨¡å—
  2. âœ… å®ç°æ‡’åŠ è½½æœºåˆ¶
  3. âœ… ç”Ÿæˆ 100 ä¸ªå¸¸ç”¨å›¾æ ‡ä½œä¸º MVP

  ç¬¬äºŒé˜¶æ®µ (3å‘¨)

  4. âœ… å®Œå–„é¢„ç”Ÿæˆè„šæœ¬
  5. âœ… ç”Ÿæˆæ‰€æœ‰ Material Symbols å›¾æ ‡
  6. âœ… æŒ‰æƒé‡/æ ·å¼æ‹†åˆ†æ¨¡å—

  ç¬¬ä¸‰é˜¶æ®µ (2å‘¨)

  7. âœ… å®ç°ç¼–è¯‘å™¨æ’ä»¶
  8. âœ… é›†æˆ Tree Shaking
  9. âœ… æµ‹è¯•æ··åˆæ–¹æ¡ˆ

  ç¬¬å››é˜¶æ®µ (1å‘¨)

  10. âœ… æ–‡æ¡£å’Œç¤ºä¾‹
  11. âœ… å‘å¸ƒ v0.4.0

  ğŸ’¡ æŠ€æœ¯æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ

  æŒ‘æˆ˜ 1: å›¾æ ‡æ•°é‡å·¨å¤§

  é—®é¢˜: Material Symbols æœ‰ 3000+ å›¾æ ‡ Ã— 7 æƒé‡ Ã— 3 æ ·å¼ = 63,000 ä¸ªæ–‡ä»¶

  è§£å†³æ–¹æ¡ˆ:
  // ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ + Gradle ç¼“å­˜
  tasks.register("generateMaterialSymbols") {
      inputs.property("version", "1.0.0")
      outputs.dir("build/generated/material-symbols")

      doLast {
          // å¹¶è¡Œç”Ÿæˆ
          launch {
              iconNames.chunked(100).map { chunk ->
                  async { generateIconsForChunk(chunk) }
              }.awaitAll()
          }
      }
  }

  æŒ‘æˆ˜ 2: IDE æ€§èƒ½

  é—®é¢˜: 63,000 ä¸ªç±»å¯èƒ½å¯¼è‡´ IDE å¡é¡¿

  è§£å†³æ–¹æ¡ˆ:
  // ä½¿ç”¨ç´¢å¼• + åŠ¨æ€ç”Ÿæˆ
  object MaterialSymbols {
      private val cache = ConcurrentHashMap<String, ImageVector>()

      operator fun get(name: String): ImageVector {
          return cache.getOrPut(name) {
              loadIcon(name) // åŠ¨æ€åŠ è½½
          }
      }
  }

  æŒ‘æˆ˜ 3: Tree Shaking å‡†ç¡®æ€§

  é—®é¢˜: åŠ¨æ€å¼•ç”¨éš¾ä»¥æ£€æµ‹

  è§£å†³æ–¹æ¡ˆ:
  // æä¾›æ³¨è§£æ ‡è®°
  @KeepIcons("home", "search", "settings")
  @Composable
  fun MyScreen() {
      // Tree Shaking ä¼šä¿ç•™è¿™äº›å›¾æ ‡
  }

  ğŸ“ æ€»ç»“

  å¯è¡Œæ€§è¯„ä¼°: âœ… å®Œå…¨å¯è¡Œ

  æ¨èæ–¹æ¡ˆ: æ··åˆæ–¹æ¡ˆ (æ–¹æ¡ˆ 3)
  - å¼€å‘ä½“éªŒæ¥è¿‘ material-icons-extended
  - ç”Ÿäº§åŒ…ä½“ç§¯æ¥è¿‘å½“å‰ SymbolCraft
  - Tree Shaking è‡ªåŠ¨ä¼˜åŒ–

  æ ¸å¿ƒä¼˜åŠ¿:
  - é›¶é…ç½®ä½¿ç”¨ (å¼€å‘é˜¶æ®µ)
  - è‡ªåŠ¨ä¼˜åŒ– (ç”Ÿäº§æ„å»º)
  - å®Œå…¨å®šåˆ¶ (é«˜çº§ç”¨æˆ·)


  SymbolCraft Runtime æ¨¡å—å¼€å‘æ–¹æ¡ˆ

  ğŸ“ æ¨¡å—æ¶æ„

  symbolcraft-runtime/
  â”œâ”€â”€ build.gradle.kts
  â”œâ”€â”€ src/
  â”‚   â”œâ”€â”€ commonMain/kotlin/io/github/kingsword09/symbolcraft/runtime/
  â”‚   â”‚   â”œâ”€â”€ MaterialSymbols.kt          # ä¸»è®¿é—®å…¥å£
  â”‚   â”‚   â”œâ”€â”€ IconLoader.kt               # å›¾æ ‡åŠ è½½å™¨
  â”‚   â”‚   â”œâ”€â”€ IconCache.kt                # ç¼“å­˜ç®¡ç†
  â”‚   â”‚   â”œâ”€â”€ IconProvider.kt             # å›¾æ ‡æä¾›è€…æ¥å£
  â”‚   â”‚   â”œâ”€â”€ LazyImageVector.kt          # æ‡’åŠ è½½åŒ…è£…å™¨
  â”‚   â”‚   â””â”€â”€ exceptions/
  â”‚   â”‚       â””â”€â”€ IconNotFoundException.kt
  â”‚   â”‚
  â”‚   â”œâ”€â”€ androidMain/kotlin/
  â”‚   â”‚   â””â”€â”€ PlatformIconLoader.android.kt
  â”‚   â”‚
  â”‚   â”œâ”€â”€ jvmMain/kotlin/
  â”‚   â”‚   â””â”€â”€ PlatformIconLoader.jvm.kt
  â”‚   â”‚
  â”‚   â”œâ”€â”€ iosMain/kotlin/
  â”‚   â”‚   â””â”€â”€ PlatformIconLoader.ios.kt
  â”‚   â”‚
  â”‚   â””â”€â”€ commonTest/kotlin/
  â”‚       â””â”€â”€ MaterialSymbolsTest.kt
  â”‚
  â””â”€â”€ README.md

  ğŸ— è¯¦ç»†å®ç°

  1. build.gradle.kts

  import org.jetbrains.kotlin.gradle.dsl.JvmTarget

  plugins {
      alias(libs.plugins.kotlinMultiplatform)
      alias(libs.plugins.androidLibrary)
      alias(libs.plugins.composeMultiplatform)
      alias(libs.plugins.composeCompiler)
      alias(libs.plugins.maven.publish)
      signing
  }

  group = "io.github.kingsword09"
  version = "0.4.0"

  kotlin {
      jvmToolchain(17)

      // ç›®æ ‡å¹³å°
      androidTarget {
          compilerOptions {
              jvmTarget.set(JvmTarget.JVM_17)
          }
      }

      jvm()

      listOf(
          iosArm64(),
          iosSimulatorArm64(),
          iosX64()
      ).forEach { iosTarget ->
          iosTarget.binaries.framework {
              baseName = "SymbolCraftRuntime"
              isStatic = true
          }
      }

      // JS æ”¯æŒ (å¯é€‰)
      js(IR) {
          browser()
          nodejs()
      }

      sourceSets {
          commonMain.dependencies {
              // Compose æ ¸å¿ƒä¾èµ–
              implementation(compose.runtime)
              implementation(compose.ui)

              // Kotlin åç¨‹ (ç”¨äºå¼‚æ­¥åŠ è½½)
              implementation(libs.kotlinx.coroutines.core)
          }

          commonTest.dependencies {
              implementation(kotlin("test"))
              implementation(libs.kotlinx.coroutines.test)
          }

          androidMain.dependencies {
              implementation(libs.androidx.core.ktx)
          }
      }
  }

  android {
      namespace = "io.github.kingsword09.symbolcraft.runtime"
      compileSdk = 34

      defaultConfig {
          minSdk = 21
      }

      compileOptions {
          sourceCompatibility = JavaVersion.VERSION_17
          targetCompatibility = JavaVersion.VERSION_17
      }
  }

  // Maven å‘å¸ƒé…ç½®
  mavenPublishing {
      publishToMavenCentral(automaticRelease = true)
      signAllPublications()

      coordinates(
          groupId = group.toString(),
          artifactId = "symbolcraft-runtime",
          version = version.toString()
      )

      pom {
          name.set("SymbolCraft Runtime")
          description.set("Runtime library for SymbolCraft icon system")
          url.set("https://github.com/kingsword09/SymbolCraft")

          licenses {
              license {
                  name.set("Apache License 2.0")
                  url.set("https://www.apache.org/licenses/LICENSE-2.0.txt")
              }
          }

          developers {
              developer {
                  id.set("kingsword09")
                  name.set("kingsword09")
                  email.set("kingsword09@gmail.com")
              }
          }

          scm {
              url.set("https://github.com/kingsword09/SymbolCraft")
              connection.set("scm:git:git://github.com/kingsword09/SymbolCraft.git")
          }
      }
  }
